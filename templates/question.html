<!DOCTYPE html>
<html lang="en">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<head>
    <link rel="stylesheet" href="{{ url_for('static', filename='question_style.css') }}">
    <meta charset="UTF-8">
    <title>Question | Ask mate</title>
    <style>
    body {
    background-image: url('https://media0.giphy.com/media/3og0Ix8tq5zyKybM9a/giphy.gif?cid=ecf05e47f00bed5bfeac0975228f848a7e1c72dce6f2767a&rid=giphy.gif');
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: center;
         background-size: cover;}
    </style>
</head>
<body>
<h1>{{ question.id }}. question</h1>

    <table>
    <h3>Tags of question:</h3>
    <tr>
        {% for tag in tags %}
        {% if tag.question_id == question_id %}
                <td>{{ tag.name }}  </td>
                <td><form action="/question/{{ question_id }}/tag/{{ tag.tag_id }}/delete" method="get">
                    <button class="button"><i class="fa fa-close"></i></button></form></td>
        {% endif %}
    {%  endfor %}
    </tr>
    {% if user_of_question == session['username'] %}
        <form action="/question/{{question_id}}/new-tag" >
                    <button class="button">Add a new tag</button></form>
    {% endif %}
    </table>
    <a href="/tags">Check tags</a>
    <br>

    <h2> {{ question.title }}</h2>
    <table style="width:50%">
            <tr><td>{{ question.message}}</td><td></td>
                {% if question.image is not none and question.image != '' %}
                    <td><img src="/{{ question.image}}" alt="pimpirimpi" height="100"></td>
                {% endif %}
            </tr>
    </table>
<table>
            <h3>Comments of question</h3>
            {% for comment in comments %}
                {% if comment.question_id ==question_id %}
                    <tr><td>{{comment.submission_time}}</td>
                        <td>{{ comment.message }}<br></td>
                    {% if comment.edited_count is not none %}
                        <td width="120">Edited {{comment.edited_count}} times</td>
                    {% else %}
                        <td width="120"></td>
                    {% endif %}
                {% if session['username'] == comment.user_name%}
                    <td><form action="/comment/{{comment.id}}/edit" >
                    <button class="button">Edit</button>
                    </form></td>
                {% endif %}
                {% if session['username'] == comment.user_name or session['username'] == user_of_question%}
                    <td><form action="/comments/{{comment.id}}/delete">
                        <button class="button" type="submit" value="Delete comment" onclick="return confirm('Are you sure you want to delete this item?')"><i class="fa fa-trash"></i></button>
                </form></td></tr>
                {% endif %}
                {% endif %}
            {% endfor %}

            <tr><td><br> {{ question.submission_time }} </td></tr>
    </table>
    <br>
    <table>
        <tr>
            <td>{% if session['username'] == user_of_question %}
            <form action="/question/{{question.id}}/edit" >
                <button class="button">Edit</button>
            </form>
            </td>
            <td>
            <form action="/question/{{question.id}}/delete" method="post">
                <button class="button" type="submit" value="Delete comment" onclick="return confirm('Are you sure you want to delete this item?')"><i class="fa fa-trash"></i></button>
            </form>
            {% endif %}</td>
            <td>
            <form action="/question/{{question.id}}/new-comment" method="get">
                <button class="button">Comment</button>
            </form>
            </td>
        </tr>
    </table>
    <br>

    <h2> Answers: </h2>
    {% for answer in answers %}
        <table style="width:50%">
        <tr style="height:100px" >
            <td>> {{ answer.submission_time }} </td>
            {% if answer.if_accepted == 1 %}
                        <td style="color:crimson">
                    {%  else %}
                        <td>
                    {%  endif %}
            {{ answer.message }} </td>
            <td>{% if answer.image is not none and answer.image != ''%}
                    <img src="/{{ answer.image }}" alt="pimpirimpi" height="100">
                {% endif %}
            </td>
            <td>
                Votes: {{ answer.vote_number }}
            </td>
            <td>
                <form action="/answer/{{answer.id}}/vote_up" >
                <button><img src="/static/buttons/try.png" width="18"></button>
                </form>
            </td>
            <td>
                <form action="/answer/{{answer.id}}/vote_down" >
                <button><img src="/static/buttons/try2.png" width="18"></button>
                </form>
            </td>
            <td> {% if session['username'] == answer.user_name %}
                <form action="/answer/{{ answer.id }}/edit">
                <button class="button">Edit</button>
                </form>
            {% endif %}</td>
            <td>{%  if session['username'] == answer.user_name or session['username'] == user_of_question %}
                <form action="/answer/{{answer.id}}/delete" >
                <button class="button"><i class="fa fa-trash"></i></button>
                </form>
            {%  endif %}</td>
            <td>{% if session['username'] == user_of_question %}
                <form action="{{url_for('accept_answer', answer_id= answer.id )}}" >
                <button class="button"><i class="fas fa-umbrella-beach">
                    {% if answer.if_accepted == 1 %}
                        Remove state
                    {%  else %}
                        Accept
                    {%  endif %}
                </i></button>
                </form>
            {% endif %}</td>
        </tr>
        </table>
        <table>
        <label style="color: white">Comments:</label>
         {%  for comment in comments %}
            {% if comment.answer_id == answer.id %}
                <tr><td>{{comment.submission_time}}</td>
                    <td>{{ comment.message }}</td>
                {% if comment.edited_count is not none %}
                    <td width="120">Edited {{comment.edited_count}} times</td>
                {% else %}
                    <td width="120"></td>
                {% endif %}
                <td>{%  if session['username'] == comment.user_name %}
                <form action="/comment/{{comment.id}}/edit" >
                <button class="button">Edit</button>
                </form>
                {%  endif %}</td>
                <td>{%  if session['username'] == comment.user_name or session['username'] == user_of_question %}
                <form action="/comments/{{comment.id}}/delete">
                    <button class="button" type="submit" value="Delete comment" onclick="return confirm('Are you sure you want to delete this item?')"><i class="fa fa-trash"></i></button>
                </form>
                {% endif %}</td></tr>
            {% endif %}
        {% endfor %}
            <td>
                <form action="/answer/{{answer.id}}/new-comment" >
                <button class="button">Add comment</button>
                </form>
            </td>
        </table>
    {% endfor %}


    <br>
    <form action="/question/{{question.id}}/new-answer">
        <button class="button">Add answer</button>
    </form>
    <br><br>
    <a href="/list"><img src="/static/buttons/whiteback.png" alt="Return to home page" width="35"></a>

</body>
</html>